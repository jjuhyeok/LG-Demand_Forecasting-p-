# LG-Demand_Forecasting-P- [(Link)](https://dacon.io/competitions/official/235985/leaderboard)

## ğŸ† Result
- **Public score 3rd** 0.60745 | **Private score 3rd** 0.58947




ì£¼ìµœ : LG AI Research

ì£¼ê´€ : DACON

ê·œëª¨ : ì´ 1400ì—¬ëª… ì°¸ê°€

===========================================================================



<img width="100%" src="https://github.com/jjuhyeok/JEJU-Jeju_Island_Traffic_Jam_Prediction/assets/49608953/280daa88-d754-44ed-85ae-186629dc3c20"/>
  
**ê°™ì´ ì°¸ì—¬í–ˆë˜ íŒ€ì›ë¶„ì˜ ê°œë°œ ë¸”ë¡œê·¸ë¥¼ ë³´ë˜ ì¤‘ ë°œê²¬í•œ ê°ë™ì ì¸ ê¸€..**  
**ë‚˜ì˜ ë…¸ë ¥ì„ ì•Œì•„ ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬í–ˆë‹¤.. ë” ì—´ì‹¬íˆ ì‚´ê²Œ ë˜ëŠ” ì›ë™ë ¥..**  

===========================================================================
  
  

  

âœï¸
**ëŒ€íšŒ ëŠë‚€ì **
 - ì‹¤ì œ ë„ë¡œì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒ(ex, ëŸ¬ì‹œì•„ì›Œ)ì„ ì ìš©í•˜ëŠ” ê³¼ì •ì—ì„œ ì™¸ë¶€ ë°ì´í„°ë¥¼ ë§ì´ ì‚¬ìš©í•˜ë©° ì„±ëŠ¥ì„ ëŒì–´ì˜¬ë ¤ ì œê³µëœ ë°ì´í„° ë¿ë§Œ ì•„ë‹Œ ì™¸ë¶€ì˜ ë§ì€ ë°ì´í„°ë¥¼ ìœµí•©í•˜ëŠ” ì‹œì•¼ë¥¼ ë„“í˜”ê³ , ì‹¤ì œ ë„ë¡œì—ì„œ ê³¼ì†ì´ë‚˜ ì°¨ëŸ‰ ì‚¬ê³  ì‹œ ë„ë¡œ ë§‰í˜ í˜„ìƒì— ëŒ€í•´
   ê³ ë ¤ë¥¼ í•´ì•¼ í•˜ëŠ”ê²ƒì´ ë§ë‚˜, ë§ì§€ ì•Šë‚˜ë¥¼ ìƒê°í•˜ë©° ë‹¤ì–‘í•œ ì´ìƒì¹˜ ì²˜ë¦¬ ë°©ë²•(3sigma, IQR)ë“¤ì„ ì ìš©ì‹œì¼œ ë³´ì•˜ê³  ì´ëŸ° ê²½í—˜ì„ í†µí•´ ë°ì´í„°ì— ë‚˜íƒ€ë‚˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ì´ìƒ í˜„ìƒì— ëŒ€í•´ ìƒê°í•˜ëŠ” ìì„¸ë¥¼ ê°€ì§€ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
   
   ë˜í•œ ëŒ€íšŒ ì¤‘ ìˆ˜ ë§ì€ í”¼ì²˜ ì¤‘ì— "Lane count" ì¦‰ ì°¨ì„  ìˆ˜ í”¼ì²˜ê°€ ì¡´ì¬í–ˆì—ˆëŠ”ë°, ì°¨ì„  ë³„ë¡œ ë‚˜ëˆ„ì–´ì„œ ëª¨ë¸ë§ì„ í–ˆë˜ ì ì´ ìˆì—ˆê³  ì˜ˆì¸¡ ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ì˜ ë‚˜ì™”ìŠµë‹ˆë‹¤.
   í•˜ì§€ë§Œ ì´ì „ ëŒ€íšŒì—ì„œ Data-Leakage ì´ìŠˆê°€ ìˆì—ˆê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ëª¨ë¸ë§ ë°©ë²•ì´ ë§ëŠ”ì§€ì— ëŒ€í•´ ìƒê°ì„ í•˜ê²Œ ë˜ì—ˆê³ ,
   train ë°ì´í„°ì…‹ì—ëŠ” ì°¨ì„ ì´ 1,2,3 ì°¨ì„  ì¢…ë¥˜ë§Œ ì¡´ì¬í–ˆì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ train ë°ì´í„°ì…‹ì— ì¡´ì¬í•˜ì§€ì•ŠëŠ” ì°¨ì„  ìˆ˜, ì˜ˆë¥¼ ë“¤ì–´ 5ì°¨ì„ , 10ì°¨ì„ ì´ test ë°ì´í„°ì…‹ì— ì¡´ì¬í•˜ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ê±°ì§€? ë¼ëŠ” ìƒê°ì´ ë“¤ì–´.
   ì´ ë°©ë²•ì€ Data-Leakage ë¼ íŒë‹¨ì„ í•˜ê³  ì´ëŸ¬í•œ ë°©ë²•ë¡ ì„ ê³¼ê°í•˜ê²Œ ë²„ë¦° í›„ ìƒˆë¡œìš´ ë°©ë²•ìœ¼ë¡œ ëª¨ë¸ë§ì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
   ëŒ€íšŒê°€ ì¢…ë£Œëœ í›„ ì €í¬ê°€ ë²„ë ¸ë˜ ë°©ë²•ë¡ ì¸ ì°¨ì„  ë³„ë¡œ ëª¨ë¸ë§ì„ ì§„í–‰í•œ íŒ€ì´ ì¡´ì¬í•˜ì˜€ê³ , ê²°êµ­ ê·¸ íŒ€ì€ 2ì°¨ í‰ê°€ì—ì„œ Data-Leakageë¡œ ì‹¤ê²©ì²˜ë¦¬ ë˜ì—ˆìŠµë‹ˆë‹¤.

   ë˜í•œ ì™¸ë¶€ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©° ì¹´ì¹´ì˜¤ë§µ APIë¥¼ ì—°ë™í•˜ì—¬ ë°©ë¬¸ììˆ˜, ë¦¬ë·°ìˆ˜ê°€ ë§ì€ êµ¬ê°„ë“¤ì€ ì‚¬ëŒë“¤ì´ ë§ì´ ëª°ë¦¬ëŠ” **Hot Place** êµ¬ê°„ìœ¼ë¡œ ê·¸ ì£¼ë³€ ë„ë¡œë“¤ì˜ í‰ê·  ì†ë„ê°€ ì „ì²´ì ìœ¼ë¡œ ë‚®ì•„ì§ˆ ê²ƒì´ë¼ëŠ” ê°€ì„¤ì„ ì„¸ìš°ê³  ëª¨ë¸ì— ì ìš©ì„ ì‹œì¼°ìŠµë‹ˆë‹¤.
   ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ì˜€ì„ ë•Œ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ê°€ì¥ ë§ì´ í–¥ìƒ ë˜ì—ˆì§€ë§Œ ì¹´ì¹´ì˜¤ë§µAPIëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ê°€ ë˜ê¸° ë•Œë¬¸ì— testì…‹ì¸ 2022ë…„ 8ì›” ë°ì´í„°ë¥¼ í¬í•¨í•˜ê²Œ ë©ë‹ˆë‹¤.
   ê·¸ë˜ì„œ ìµœì¢…ì ìœ¼ë¡œ ì¹´ì¹´ì˜¤ë§µ APIë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ë²„ë¦¬ê²Œ ë˜ì—ˆì§€ë§Œ, ì‹¤ì œ end-to-end ëª¨ë¸ì„ ê°œë°œí•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ì˜ˆì¸¡í•  ë•ŒëŠ” ë§ì€ ë„ì›€ì´ ë  ê²ƒì´ë¼ ìƒê°í•˜ì—¬ ì£¼ìµœì‚¬ì¸¡ì— ì˜ê²¬ ì „ë‹¬ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.
   
   ì´ëŸ¬í•œ ê²½í—˜ì„ í†µí•´ í˜„ì¬ ì œê³µëœ ë°ì´í„°ì…‹(train)ì—ì„œ ì–´ë–»ê²Œ test ë°ì´í„°ë¥¼ ë³´ì§€ ì•Šê³  ì¼ë°˜í™” ì„±ëŠ¥ì„ ì˜¬ë¦¬ëŠ”ì§€ì— ëŒ€í•´ ë§ì€ ìƒê°ì„ í•  ìˆ˜ ìˆì—ˆê³  ì•ìœ¼ë¡œë„ ì´ëŸ¬í•œ ì´ìŠˆì—ëŠ” ìœ ì—°í•˜ê²Œ ì˜ ëŒ€ì‘ì„ í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

===========================================================================

ìŠ¤íƒœí‚¹ ì•™ìƒë¸” ë“± ë‹¤ì–‘í•œ ê¸°ë²•ë“¤ì„ ì‹œë„í•˜ì—¬ ì„±ëŠ¥ì„ ìµœëŒ€í•œìœ¼ë¡œ ëŒì–´ì˜¬ë ¤ë³´ë ¤ í–ˆì§€ë§Œ
Data-Leakageì— ìœ„ë°˜ì´ ë˜ì§€ ì•ŠëŠ” ê²ƒì´ ë” ì¤‘ìš”í•˜ë‹¤ ìƒê°ì´ ë“¤ì–´ ë§ˆì§€ë§‰ ì‹œê°„ì€ ì½”ë“œ ì ê²€ì—ë§Œ ì‹œê°„ì„ ìŸì•˜ìŠµë‹ˆë‹¤.

ë‹¤ì–‘í•œ ëª¨ë¸ë§ ê¸°ë²•ì„ ì œëŒ€ë¡œ í•´ë³´ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ í–¥ìƒ ê°€ëŠ¥ì„±ì´ ë†’ì€ ì½”ë“œë¼ ìƒê°í•©ë‹ˆë‹¤.

Data-Leakageì— ìœ„í—˜í•˜ë‹¤ ìƒê°ë˜ëŠ” ì½”ë“œë“¤ì€ ë§ˆì§€ë§‰ì— ëª¨ë‘ ì‚­ì œí•˜ì˜€ìœ¼ë©° ìµœì¢… ì œì¶œ ì ìˆ˜ë„ ê°€ì¥ ë†’ì€ PB Scoreê°€ ì•„ë‹Œ ìœ„í—˜í•˜ë‹¤ ìƒê°í•œ í”¼ì²˜ë“¤ì„ ëª¨ë‘ ì‚­ì œí•˜ê³  í•™ìŠµ, ì˜ˆì¸¡í•œ ì•ˆì „í•œ PB Scoreë¡œ ì œì¶œ í•˜ì—¬ Public Score 2ë“±ì—ì„œ Private Score 4ë“±ìœ¼ë¡œ ë§ˆë¬´ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

===========================================================================


## Data Info

* ê°ê°ì˜ ì¹¼ëŸ¼ì— ëŒ€í•œ ì„¤ëª…
* Features 
  * ì•„ì´ë”” / ë‚ ì§œ / ìš”ì¼ / ì‹œê°„ëŒ€ / ì°¨ë¡œ ìˆ˜ / ë„ë¡œ ë“±ê¸‰ / ì¤‘ìš©êµ¬ê°„ ì—¬ë¶€ / ì—°ê²°ë¡œ ì½”ë“œ / ìµœê³  ì†ë„ ì œí•œ / í†µê³¼ ì œí•œ í•˜ì¤‘ / í†µê³¼ ì œí•œ ë†’ì´ / ë„ë¡œ ìœ í˜• / ì‹œì‘ ì§€ì  ìœ„ë„ / ì‹œì‘ ì§€ì  ê²½ë„ / ë„ì°© ì§€ì  ìœ„ë„ / ë„ì°© ì§€ì  ê²½ë„ / ì‹œì‘ ì§€ì  íšŒì „ ì œí•œ ì—¬ë¶€ / ë„ì°© ì§€ì  íšŒì „ ì œíŒ ì—¬ë¶€ / ë„ë¡œ ëª… / ì‹œì‘ ì§€ì  ëª… / ë„ì‘ ì§€ì  ëª… / í†µê³¼ ì œí•œ ì°¨ëŸ‰
* Target
  * í‰ê·  ì†ë„ (KM)
  
### Train Set

* Rows : 4,701,217 ê°œ
* Columns : 24 ê°œ
  * float64 : 9 ê°œ
  * int64 : 8 ê°œ
  * object : 7ê°œ

### Test Set

* Rows : 291,241 ê°œ
* Columns : 23 ê°œ
  * float64 : 8 ê°œ
  * int64 : 8 ê°œ
  * object : 7ê°œ
  
---

## Process

**1. EDA** 
  * í‰ê·  ë„ë¡œ ì†ë„ê°€ 40ì¸ ë„ë¡œì˜ í‰ê·  ì†ë„ê°€ 40ì„ ì´ˆê³¼í•˜ëŠ” ì œì¼ ë†’ì€ ì†ë„ì„ì„ í™•ì¸, ë°ì´í„° ë¶ˆê· í˜• í™•ì¸
  * 2022ë…„ 7ì›” ì´ì „ê³¼ ì´í›„ë¡œ í‰ê·  targetê°’ì˜ ì°¨ì´ê°€ ì‹¬í•¨ì„ íŒŒì•…
  * ê° ë„ë¡œì˜ íŠ¹ì§• ë³„ë¡œ targetê°’ì˜ ì°¨ì´ê°€ ì‹¬í•¨ì„ íŒŒì•…
  * ê° ë„ë¡œë§ˆë‹¤ targetì˜ ì´ìƒê°’ì´ ì¡´ì¬ -> ì‚¬ê³  or í­ì£¼ë¡œ ìƒê°
  * ìš”ì¼, ì‹œê°„ëŒ€ë³„ë¡œ target ê°’ ì°¨ì´ ì¡´ì¬
  
**2. Feature Engineering** 
  * ì‹œê°„ featureë“¤ì€ inherently cyclical í•˜ë‹¤ëŠ” íŠ¹ì§•ì„ í™œìš©í•˜ê¸° ìœ„í•´ sin/cos ë³€í™˜
  * íŠ¹ì • í”¼ì²˜ë“¤ì˜ target ê°’ì˜ í‰ê· ìœ¼ë¡œ íŒŒìƒ ë³€ìˆ˜ ìƒì„±
  * ìœ„,ê²½ë„ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ clustering í•˜ì—¬ íŒŒìƒ ë³€ìˆ˜ ìƒì„± -> íŠ¹ì • ë„ë¡œëŠ” ì¸ì ‘í•œ ë„ë¡œì™ êµí†µëŸ‰ì— ì˜í–¥ì„ ë¯¸ì¹ ê²ƒì´ë€ ê°€ì„¤
  * ì œì£¼ë„ ê´€ê´‘ì§€ ì™¸ë¶€ë°ì´í„°ë¥¼ í™œìš©í•´ ìœ„,ê²½ë„ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ íŠ¹ì • ê±°ë¦¬ ë‚´ì˜ ê´€ê´‘ì§€ë“¤ì„ countí•˜ëŠ” íŒŒìƒ ë³€ìˆ˜ ìƒì„± -> ê´€ê´‘ì§€ê°€ ë§ì€ ê³³ì€ êµí†µëŸ‰ì´ í˜¼ì¡í•  ê²ƒì´ë‹¤ ë¼ëŠ” ê°€ì„¤
  * ê³µíœ´ì¼ ì™¸ë¶€ë°ì´í„°ë¥¼ í™œìš©í•´ ê³µíœ´ì¼ ë‹¹ì¼, ì „,í›„ë‚  íŒŒìƒë³€ìˆ˜ ìƒì„± -> ê³µíœ´ì¼ì—ëŠ” êµí†µëŸ‰ì´ ë§ì„ ê²ƒì´ë¼ëŠ” ê°€ì„¤
  * ì´ì™¸ì˜ feature engineeringì„ í†µí•´ ì´ 48ê°œì˜ í”¼ì²˜ë¡œ í•™ìŠµ ì§„í–‰

**3. Modeling**

  * XGBoostRegressor ëª¨ë¸ ì‚¬ìš©
  * Optunaë¥¼ í™œìš©í•˜ì—¬ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
  * êµì°¨ ê²€ì¦ í™œìš©(stratified k-fold cross validation)
  * target ê°’ì€ ì •ìˆ˜í˜•ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤ëŠ” ì‚¬ì‹¤ì— ê¸°ë°˜í•˜ì—¬ ì˜ˆì¸¡ê°’ì„ round 

**ì¶”ê°€ ì‹œë„ ì‚¬í•­** (ìµœì¢… ê²°ê³¼ ë„ì¶œì—ëŠ” ë¹„ì‚¬ìš©)
  * IQR * 1.5 2.0 ë“±ë“± ê°’ì„ ë³€í™”í•´ê°€ë©° í­ì£¼ or ì‚¬ê³ ë¼ê³  ìƒê°í•˜ëŠ” ì´ìƒì¹˜ë“¤ì„ drop -> ì •í™•ë„ê°€ ì˜¤íˆë ¤ ë‚®ì•„ì§
  * 3 sigma ë²•ì¹™ì„ ì´ìš©í•´ í­ì£¼ or ì‚¬ê³ ë¼ê³  ìƒê°í•˜ëŠ” ì´ìƒì¹˜ë“¤ì„ drop -> ì •í™•ë„ê°€ ì˜¤íˆë ¤ ë‚®ì•„ì§
  * Stacking ê¸°ë²• -> ë§ˆì§€ë§‰ì— ì‹œë„í•˜ì˜€ì§€ë§Œ ì‹œê°„ì´ ë¶€ì¡±í•´ base modelì˜ ì¶©ë¶„í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ì„ í•˜ì§€ ëª»í•´ ì„±ëŠ¥ì´ ì•½ê°„ í•˜ë½
    -> ëŒ€íšŒ ì¢…ë£Œ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì˜€ë”ë‹ˆ Stacking ê¸°ë²•ì´ ë” ì ìˆ˜ê°€ ì¢‹ì•˜ìŒ
  * ê´€ê´‘ì§€ ê´€ë ¨ íŒŒìƒë³€ìˆ˜ ìƒì„±í•  ë•Œ ì¹´ì¹´ì˜¤ë§µ APIë¥¼ ì‚¬ìš©í•˜ì˜€ëŠ”ë° DataLeakageë¡œ ìµœì¢… ì œì¶œì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ -> ì œì¼ ì„±ëŠ¥ì´ ì¢‹ì•˜ìŒ
  * ë‹¤ì–‘í•œ KFold K ë³€ê²½


  
